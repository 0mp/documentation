\clearpage
\phantomsection
\addcontentsline{toc}{subsection}{memref}
\label{subr:memref}
\subsection*{memref: return scratch memory}

\subsubsection*{Subroutine prototype}

\begin{verbatim}
uintptr_t * memref(uintptr_t ptr, size_t length);
\end{verbatim}

\subsubsection*{Calling convention}

\begin{description}
\item[\registerop{arg0}] Pointer to memory
\item[\registerop{arg1}] Length of scratch memory to use
\item[\registerop{rd}] Pointer to a fixed size of scratch memory
\end{description}

\subsubsection*{Description}

The \subroutine{memref} subroutine allocates memory from scratch
space and returns that memory to the caller.

\subsubsection*{Pseudocode}

\begin{verbatim}
size = sizeof(uintptr_t) * 2
memref = scratch_space
memref[0] = stack[0].value
memref[1] = stack[1].value
scratch_space += size
%rd = memref
\end{verbatim}

\subsubsection*{Failure modes}

This subroutine has no run-time failure modes beyond its constraints.
